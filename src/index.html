<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stock Tracker</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        
        <!-- GitHub Authentication Modal -->
        <div id="github-auth-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>GitHub Authentication</h3>
                    <span class="close" id="close-auth-modal">&times;</span>
                </div>
                <div class="modal-body">
                    <p style="margin-bottom: 25px; color: #666;">To save your portfolio to GitHub, please provide your authentication details:</p>
                    <form id="github-auth-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="repo-owner">Repository Owner:</label>
                                <input type="text" id="repo-owner" value="jeromevde" required>
                            </div>
                            <div class="form-group">
                                <label for="repo-name">Repository Name:</label>
                                <input type="text" id="repo-name" value="Stocks" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="github-token">GitHub Personal Access Token:</label>
                            <input type="password" id="github-token" placeholder="ghp_..." required>
                            <small style="margin-top: 8px; display: block;">Need a token? <a href="https://github.com/settings/tokens/new?scopes=repo" target="_blank">Create one here</a> (requires 'repo' scope)</small>
                        </div>
                        <div class="modal-buttons">
                            <button type="submit" class="btn-primary">Connect to GitHub</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- GitHub Status Section (only visible when authenticated) -->
        <div id="github-status" style="display: none;">
            <div class="github-connected">
                <span id="github-info">âœ… Connected to GitHub</span>
                <button id="github-logout" class="btn-secondary">Disconnect</button>
            </div>
        </div>

        <!-- Notes Popup -->
        <div id="notes-popup-overlay" class="notes-popup-overlay">
            <div class="notes-popup-content">
                <div class="notes-popup-header">
                    <h3 id="notes-popup-title">Edit Notes</h3>
                    <button class="notes-popup-close" id="notes-popup-close">&times;</button>
                </div>
                <div class="notes-popup-body">
                    <textarea id="notes-textarea" class="notes-textarea" placeholder="Add your notes here..."></textarea>
                </div>
            </div>
        </div>

        <!-- Portfolio Actions -->
        <div id="portfolio-actions" class="actions-section">
            <button id="save-portfolio" class="btn-primary" disabled>ðŸ’¾ Save to GitHub</button>
            <button id="refresh-portfolio" class="btn-secondary">ðŸ”„ Refresh from GitHub</button>
            <span id="save-status" class="status-message"></span>
        </div>

        <table id="portfolio-table">
            <thead>
                <tr>
                    <th>â˜…</th>
                    <th>Ticker</th>
                    <th>Start Date</th>
                    <th id="label-header" style="cursor:pointer; position:relative;">Label
                        <div id="label-filter-dropdown" style="display:none; position:fixed; background:#fff; border:1px solid #ccc; z-index:1000; min-width:120px; padding:8px; border-radius:4px; box-shadow:0 2px 8px rgba(0,0,0,0.15);"></div>
                    </th>
                    <th>Notes</th>
                    <th>Current Price</th>
                    <th id="sort-cumret" style="cursor:pointer;">Cumulative Return</th>
                    <th style="width: 30px;"></th>
                </tr>
            </thead>
            <tbody id="portfolio-tbody"></tbody>
        </table>

        <form id="stock-form" style="margin-top: 20px; width: 100%;">
            <label for="stock-input" style="display: block; margin-bottom: 8px; font-weight: bold;">Add Stock:</label>
            <input id="stock-input" name="stock-input" list="ticker-list" placeholder="Search ticker (e.g. TSLA)" autocomplete="off" required style="width: 100%; padding: 12px; font-size: 16px; border: 2px solid #ddd; border-radius: 8px; box-sizing: border-box;">
            <datalist id="ticker-list"></datalist>
        </form>
    </div>
    <script src="utils/github.js"></script>
    <script src="appp.js"></script>
</body>
</html>